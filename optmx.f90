subroutine optmx(il,schmidt,dt,phibar,accel)
   
   ! Calculate the optimum acceleration factor for SOR on the cubic-conformal
   ! grid. Linearly interpolate tabulated values as a function of lambda,
   ! resolution and stretching. Tabulated values were calculated using
   ! adaptive SOR.

   implicit none
   integer, intent(in) :: il    ! Number of grid points on a panel
   real, intent(in) :: schmidt  ! Stretch factor
   real, intent(in) :: dt       ! Time step
   real, intent(in) :: phibar   ! Equivalent depth
   real, intent(out) :: accel
   real, parameter :: radsq=6.371e6**2

   integer :: i, j, k
   real :: loglam, logstr, wl, wr, ws
   integer, parameter :: nlam=38, nres=14, nsch=9
   real, dimension(nlam,nres,nsch), save :: omega
   real, parameter, dimension(nres) :: resol = (/  20, 30, 40, 50, 60, 70, &
        80, 90, 100, 120, 140, 160, 180, 200 /)

   data (omega(i, 1, 1),i=1,nlam) /  &
      1.8525,1.8302,1.7941,1.7407,1.6672,1.5785,1.4818,1.3834,    &
      1.2855,1.1957,1.1156,1.0611,1.0279,1.0000,1.0000,1.0000,    &
      1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,    &
      1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,    &
      1.0000,1.0000,1.0000,1.0000,1.0000,1.0000 /
   data (omega(i, 2, 1),i=1,nlam) /  &
      1.9035,1.8877,1.8612,1.8222,1.7676,1.6982,1.6177,1.5296,    &
      1.4358,1.3382,1.2442,1.1550,1.0888,1.0440,1.0189,1.0000,    &
      1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,    &
      1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,    &
      1.0000,1.0000,1.0000,1.0000,1.0000,1.0000 /
   data (omega(i, 3, 1),i=1,nlam) /  &
      1.9301,1.9179,1.8974,1.8662,1.8226,1.7658,1.6995,1.6241,    &
      1.5378,1.4453,1.3481,1.2537,1.1682,1.0948,1.0478,1.0208,    &
      1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,    &
      1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,    &
      1.0000,1.0000,1.0000,1.0000,1.0000,1.0000 /
   data (omega(i, 4, 1),i=1,nlam) /  &
      1.9463,1.9362,1.9198,1.8942,1.8574,1.8095,1.7521,1.6873,    &
      1.6121,1.5246,1.4322,1.3345,1.2408,1.1523,1.0868,1.0428,    &
      1.0183,1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,    &
      1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,    &
      1.0000,1.0000,1.0000,1.0000,1.0000,1.0000 /
   data (omega(i, 5, 1),i=1,nlam) /  &
      1.9569,1.9487,1.9347,1.9129,1.8814,1.8400,1.7899,1.7322,    &
      1.6655,1.5852,1.4972,1.4017,1.3059,1.2144,1.1306,1.0714,    &
      1.0337,1.0139,1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,    &
      1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,    &
      1.0000,1.0000,1.0000,1.0000,1.0000,1.0000 /
   data (omega(i, 6, 1),i=1,nlam) /  &
      1.9645,1.9575,1.9457,1.9269,1.8995,1.8624,1.8180,1.7663,    &
      1.7063,1.6342,1.5502,1.4599,1.3627,1.2676,1.1803,1.1039,    &
      1.0535,1.0238,1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,    &
      1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,    &
      1.0000,1.0000,1.0000,1.0000,1.0000,1.0000 /
   data (omega(i, 7, 1),i=1,nlam) /  &
      1.9701,1.9640,1.9538,1.9373,1.9129,1.8797,1.8396,1.7932,    &
      1.7382,1.6723,1.5952,1.5066,1.4117,1.3160,1.2237,1.1381,    &
      1.0767,1.0367,1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,    &
      1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,    &
      1.0000,1.0000,1.0000,1.0000,1.0000,1.0000 /
   data (omega(i, 8, 1),i=1,nlam) /  &
      1.9741,1.9691,1.9600,1.9456,1.9238,1.8938,1.8569,1.8145,    &
      1.7635,1.7032,1.6313,1.5470,1.4567,1.3594,1.2645,1.1776,    &
      1.1019,1.0522,1.0231,1.0000,1.0000,1.0000,1.0000,1.0000,    &
      1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,    &
      1.0000,1.0000,1.0000,1.0000,1.0000,1.0000 /
   data (omega(i, 9, 1),i=1,nlam) /  &
      1.9775,1.9727,1.9650,1.9521,1.9323,1.9049,1.8715,1.8321,    &
      1.7861,1.7292,1.6617,1.5834,1.4946,1.3983,1.3025,1.2114,    &
      1.1282,1.0697,1.0327,1.0135,1.0000,1.0000,1.0000,1.0000,    &
      1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,    &
      1.0000,1.0000,1.0000,1.0000,1.0000,1.0000 /
   data (omega(i,10, 1),i=1,nlam) /  &
      1.9825,1.9786,1.9721,1.9617,1.9455,1.9219,1.8931,1.8597,    &
      1.8194,1.7696,1.7100,1.6395,1.5579,1.4668,1.3697,1.2744,    &
      1.1863,1.1085,1.0565,1.0254,1.0000,1.0000,1.0000,1.0000,    &
      1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,    &
      1.0000,1.0000,1.0000,1.0000,1.0000,1.0000 /
   data (omega(i,11, 1),i=1,nlam) /  &
      1.9859,1.9828,1.9773,1.9683,1.9547,1.9345,1.9089,1.8795,    &
      1.8440,1.8003,1.7465,1.6824,1.6074,1.5212,1.4282,1.3306,    &
      1.2373,1.1493,1.0847,1.0415,1.0000,1.0000,1.0000,1.0000,    &
      1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,    &
      1.0000,1.0000,1.0000,1.0000,1.0000,1.0000 /
   data (omega(i,12, 1),i=1,nlam) /  &
      1.9880,1.9857,1.9811,1.9734,1.9617,1.9441,1.9209,1.8947,    &
      1.8629,1.8237,1.7751,1.7166,1.6472,1.5669,1.4767,1.3799,    &
      1.2844,1.1951,1.1153,1.0610,1.0278,1.0000,1.0000,1.0000,    &
      1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,    &
      1.0000,1.0000,1.0000,1.0000,1.0000,1.0000 /
   data (omega(i,13, 1),i=1,nlam) /  &
      1.9893,1.9876,1.9840,1.9773,1.9667,1.9514,1.9307,1.9066,    &
      1.8780,1.8424,1.7983,1.7443,1.6798,1.6047,1.5182,1.4251,    &
      1.3274,1.2343,1.1469,1.0829,1.0404,1.0000,1.0000,1.0000,    &
      1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,    &
      1.0000,1.0000,1.0000,1.0000,1.0000,1.0000 /
   data (omega(i,14, 1),i=1,nlam) /  &
      1.9908,1.9894,1.9862,1.9803,1.9710,1.9573,1.9383,1.9163,    &
      1.8901,1.8576,1.8171,1.7671,1.7072,1.6364,1.5539,1.4634,    &
      1.3663,1.2712,1.1835,1.1063,1.0551,1.0246,1.0000,1.0000,    &
      1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,    &
      1.0000,1.0000,1.0000,1.0000,1.0000,1.0000 /
   data (omega(i, 1, 2),i=1,nlam) /  &
      1.9333,1.9063,1.8777,1.8402,1.7914,1.7271,1.6457,1.5476,    &
      1.4419,1.3413,1.2440,1.1527,1.0873,1.0433,1.0188,1.0000,    &
      1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,    &
      1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,    &
      1.0000,1.0000,1.0000,1.0000,1.0000,1.0000 /
   data (omega(i, 2, 2),i=1,nlam) /  &
      1.9563,1.9415,1.9223,1.8967,1.8615,1.8148,1.7515,1.6735,    &
      1.5849,1.4908,1.3945,1.2956,1.2047,1.1212,1.0652,1.0304,    &
      1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,    &
      1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,    &
      1.0000,1.0000,1.0000,1.0000,1.0000,1.0000 /
   data (omega(i, 3, 2),i=1,nlam) /  &
      1.9695,1.9588,1.9448,1.9256,1.8989,1.8617,1.8122,1.7480,    &
      1.6733,1.5907,1.4997,1.4047,1.3055,1.2138,1.1284,1.0701,    &
      1.0332,1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,    &
      1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,    &
      1.0000,1.0000,1.0000,1.0000,1.0000,1.0000 /
   data (omega(i, 4, 2),i=1,nlam) /  &
      1.9773,1.9691,1.9582,1.9433,1.9219,1.8916,1.8499,1.7956,    &
      1.7315,1.6600,1.5782,1.4860,1.3909,1.2920,1.2016,1.1188,    &
      1.0636,1.0296,1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,    &
      1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,    &
      1.0000,1.0000,1.0000,1.0000,1.0000,1.0000 /
   data (omega(i, 5, 2),i=1,nlam) /  &
      1.9824,1.9758,1.9670,1.9549,1.9373,1.9120,1.8767,1.8295,    &
      1.7729,1.7095,1.6355,1.5517,1.4583,1.3617,1.2640,1.1769,    &
      1.1001,1.0513,1.0229,1.0000,1.0000,1.0000,1.0000,1.0000,    &
      1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,    &
      1.0000,1.0000,1.0000,1.0000,1.0000,1.0000 /
   data (omega(i, 6, 2),i=1,nlam) /  &
      1.9854,1.9805,1.9732,1.9627,1.9481,1.9265,1.8957,1.8542,    &
      1.8046,1.7471,1.6807,1.6025,1.5148,1.4193,1.3200,1.2271,    &
      1.1390,1.0776,1.0376,1.0000,1.0000,1.0000,1.0000,1.0000,    &
      1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,    &
      1.0000,1.0000,1.0000,1.0000,1.0000,1.0000 /
   data (omega(i, 7, 2),i=1,nlam) /  &
      1.9880,1.9839,1.9777,1.9688,1.9562,1.9373,1.9107,1.8739,    &
      1.8283,1.7765,1.7159,1.6435,1.5609,1.4685,1.3721,1.2739,    &
      1.1856,1.1065,1.0555,1.0251,1.0000,1.0000,1.0000,1.0000,    &
      1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,    &
      1.0000,1.0000,1.0000,1.0000,1.0000,1.0000 /
   data (omega(i, 8, 2),i=1,nlam) /  &
      1.9893,1.9861,1.9812,1.9734,1.9625,1.9460,1.9221,1.8889,    &
      1.8481,1.8009,1.7450,1.6768,1.5995,1.5104,1.4161,1.3168,    &
      1.2241,1.1367,1.0759,1.0366,1.0000,1.0000,1.0000,1.0000,    &
      1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,    &
      1.0000,1.0000,1.0000,1.0000,1.0000,1.0000 /
   data (omega(i, 9, 2),i=1,nlam) /  &
      1.9909,1.9876,1.9838,1.9770,1.9674,1.9527,1.9316,1.9016,    &
      1.8638,1.8203,1.7687,1.7057,1.6322,1.5483,1.4550,1.3583,    &
      1.2607,1.1741,1.0980,1.0500,1.0222,1.0000,1.0000,1.0000,    &
      1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,    &
      1.0000,1.0000,1.0000,1.0000,1.0000,1.0000 /
   data (omega(i,10, 2),i=1,nlam) /  &
      1.9922,1.9905,1.9873,1.9823,1.9742,1.9627,1.9451,1.9201,    &
      1.8878,1.8506,1.8055,1.7511,1.6856,1.6081,1.5202,1.4263,    &
      1.3270,1.2336,1.1444,1.0814,1.0398,1.0000,1.0000,1.0000,    &
      1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,    &
      1.0000,1.0000,1.0000,1.0000,1.0000,1.0000 /
   data (omega(i,11, 2),i=1,nlam) /  &
      1.9938,1.9918,1.9894,1.9855,1.9793,1.9697,1.9548,1.9338,    &
      1.9058,1.8732,1.8327,1.7845,1.7254,1.6545,1.5739,1.4828,    &
      1.3869,1.2882,1.1983,1.1162,1.0619,1.0286,1.0000,1.0000,    &
      1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,    &
      1.0000,1.0000,1.0000,1.0000,1.0000,1.0000 /
   data (omega(i,12, 2),i=1,nlam) /  &
      1.9935,1.9933,1.9906,1.9881,1.9829,1.9748,1.9621,1.9437,    &
      1.9194,1.8901,1.8542,1.8104,1.7573,1.6931,1.6166,1.5318,    &
      1.4366,1.3396,1.2432,1.1593,1.0871,1.0433,1.0189,1.0000,    &
      1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,    &
      1.0000,1.0000,1.0000,1.0000,1.0000,1.0000 /
   data (omega(i,13, 2),i=1,nlam) /  &
      1.9945,1.9933,1.9921,1.9895,1.9857,1.9787,1.9676,1.9513,    &
      1.9298,1.9034,1.8715,1.8317,1.7823,1.7233,1.6519,1.5714,    &
      1.4796,1.3837,1.2851,1.1955,1.1141,1.0605,1.0278,1.0000,    &
      1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,    &
      1.0000,1.0000,1.0000,1.0000,1.0000,1.0000 /
   data (omega(i,14, 2),i=1,nlam) /  &
      1.9953,1.9943,1.9932,1.9910,1.9874,1.9814,1.9720,1.9575,    &
      1.9381,1.9146,1.8852,1.8487,1.8033,1.7488,1.6830,1.6051,    &
      1.5189,1.4229,1.3237,1.2305,1.1418,1.0796,1.0387,1.0000,    &
      1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,    &
      1.0000,1.0000,1.0000,1.0000,1.0000,1.0000 /
   data (omega(i, 1, 3),i=1,nlam) /  &
      1.9503,1.9368,1.9213,1.9003,1.8732,1.8363,1.7868,1.7224,    &
      1.6395,1.5399,1.4319,1.3303,1.2333,1.1432,1.0805,1.0393,    &
      1.0169,1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,    &
      1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,    &
      1.0000,1.0000,1.0000,1.0000,1.0000,1.0000 /
   data (omega(i, 2, 3),i=1,nlam) /  &
      1.9704,1.9622,1.9518,1.9385,1.9204,1.8947,1.8595,1.8117,    &
      1.7482,1.6675,1.5768,1.4808,1.3835,1.2843,1.1945,1.1128,    &
      1.0597,1.0275,1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,    &
      1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,    &
      1.0000,1.0000,1.0000,1.0000,1.0000,1.0000 /
   data (omega(i, 3, 3),i=1,nlam) /  &
      1.9801,1.9746,1.9669,1.9573,1.9436,1.9248,1.8977,1.8602,    &
      1.8095,1.7435,1.6667,1.5823,1.4914,1.3937,1.2942,1.2034,    &
      1.1196,1.0643,1.0300,1.0000,1.0000,1.0000,1.0000,1.0000,    &
      1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,    &
      1.0000,1.0000,1.0000,1.0000,1.0000,1.0000 /
   data (omega(i, 4, 3),i=1,nlam) /  &
      1.9857,1.9816,1.9758,1.9684,1.9576,1.9429,1.9213,1.8906,    &
      1.8486,1.7931,1.7260,1.6529,1.5693,1.4776,1.3798,1.2807,    &
      1.1915,1.1105,1.0582,1.0267,1.0000,1.0000,1.0000,1.0000,    &
      1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,    &
      1.0000,1.0000,1.0000,1.0000,1.0000,1.0000 /
   data (omega(i, 5, 3),i=1,nlam) /  &
      1.9881,1.9856,1.9814,1.9755,1.9668,1.9547,1.9368,1.9115,    &
      1.8756,1.8272,1.7694,1.7035,1.6276,1.5424,1.4476,1.3506,    &
      1.2529,1.1673,1.0926,1.0467,1.0206,1.0000,1.0000,1.0000,    &
      1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,    &
      1.0000,1.0000,1.0000,1.0000,1.0000,1.0000 /
   data (omega(i, 6, 3),i=1,nlam) /  &
      1.9905,1.9881,1.9850,1.9805,1.9731,1.9627,1.9480,1.9262,    &
      1.8950,1.8530,1.8012,1.7419,1.6741,1.5940,1.5049,1.4084,    &
      1.3086,1.2165,1.1299,1.0713,1.0340,1.0000,1.0000,1.0000,    &
      1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,    &
      1.0000,1.0000,1.0000,1.0000,1.0000,1.0000 /
   data (omega(i, 7, 3),i=1,nlam) /  &
      1.9913,1.9895,1.9872,1.9836,1.9778,1.9688,1.9562,1.9372,    &
      1.9102,1.8724,1.8257,1.7730,1.7098,1.6357,1.5516,1.4579,    &
      1.3609,1.2627,1.1758,1.0987,1.0506,1.0226,1.0000,1.0000,    &
      1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,    &
      1.0000,1.0000,1.0000,1.0000,1.0000,1.0000 /
   data (omega(i, 8, 3),i=1,nlam) /  &
      1.9927,1.9912,1.9893,1.9862,1.9813,1.9735,1.9626,1.9458,    &
      1.9218,1.8882,1.8461,1.7972,1.7399,1.6716,1.5910,1.5003,    &
      1.4051,1.3054,1.2136,1.1276,1.0697,1.0331,1.0000,1.0000,    &
      1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,    &
      1.0000,1.0000,1.0000,1.0000,1.0000,1.0000 /
   data (omega(i, 9, 3),i=1,nlam) /  &
      1.9938,1.9925,1.9901,1.9877,1.9840,1.9772,1.9676,1.9527,    &
      1.9311,1.9011,1.8621,1.8179,1.7642,1.7001,1.6242,1.5388,    &
      1.4443,1.3471,1.2497,1.1646,1.0906,1.0455,1.0200,1.0000,    &
      1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,    &
      1.0000,1.0000,1.0000,1.0000,1.0000,1.0000 /
   data (omega(i,10, 3),i=1,nlam) /  &
      1.9953,1.9933,1.9925,1.9900,1.9870,1.9825,1.9749,1.9628,    &
      1.9450,1.9199,1.8871,1.8487,1.8019,1.7460,1.6791,1.5998,    &
      1.5102,1.4154,1.3156,1.2229,1.1350,1.0749,1.0361,1.0000,    &
      1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,    &
      1.0000,1.0000,1.0000,1.0000,1.0000,1.0000 /
   data (omega(i,11, 3),i=1,nlam) /  &
      1.9949,1.9947,1.9928,1.9920,1.9897,1.9856,1.9800,1.9699,    &
      1.9550,1.9334,1.9055,1.8719,1.8308,1.7803,1.7198,1.6486,    &
      1.5649,1.4724,1.3758,1.2770,1.1882,1.1080,1.0566,1.0258,    &
      1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,    &
      1.0000,1.0000,1.0000,1.0000,1.0000,1.0000 /
   data (omega(i,12, 3),i=1,nlam) /  &
      1.9958,1.9956,1.9941,1.9921,1.9907,1.9877,1.9832,1.9751,    &
      1.9622,1.9435,1.9194,1.8897,1.8524,1.8077,1.7523,1.6866,    &
      1.6084,1.5217,1.4257,1.3258,1.2324,1.1427,1.0803,1.0393,    &
      1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,    &
      1.0000,1.0000,1.0000,1.0000,1.0000,1.0000 /
   data (omega(i,13, 3),i=1,nlam) /  &
      1.9964,1.9963,1.9950,1.9933,1.9922,1.9897,1.9859,1.9790,    &
      1.9678,1.9513,1.9300,1.9032,1.8702,1.8290,1.7782,1.7177,    &
      1.6459,1.5623,1.4692,1.3725,1.2738,1.1854,1.1060,1.0552,    &
      1.0251,1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,    &
      1.0000,1.0000,1.0000,1.0000,1.0000,1.0000 /
   data (omega(i,14, 3),i=1,nlam) /  &
      1.9969,1.9969,1.9957,1.9943,1.9920,1.9903,1.9874,1.9820,    &
      1.9722,1.9577,1.9385,1.9147,1.8846,1.8463,1.8005,1.7433,    &
      1.6763,1.5965,1.5070,1.4120,1.3123,1.2198,1.1326,1.0732,    &
      1.0351,1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,    &
      1.0000,1.0000,1.0000,1.0000,1.0000,1.0000 /
   data (omega(i, 1, 4),i=1,nlam) /  &
      1.9630,1.9551,1.9462,1.9346,1.9197,1.8993,1.8721,1.8352,    &
      1.7857,1.7212,1.6380,1.5380,1.4294,1.3276,1.2305,1.1408,    &
      1.0788,1.0384,1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,    &
      1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,    &
      1.0000,1.0000,1.0000,1.0000,1.0000,1.0000 /
   data (omega(i, 2, 4),i=1,nlam) /  &
      1.9789,1.9741,1.9686,1.9611,1.9512,1.9379,1.9197,1.8941,    &
      1.8589,1.8109,1.7472,1.6662,1.5748,1.4782,1.3807,1.2814,    &
      1.1920,1.1107,1.0583,1.0268,1.0000,1.0000,1.0000,1.0000,    &
      1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,    &
      1.0000,1.0000,1.0000,1.0000,1.0000,1.0000 /
   data (omega(i, 3, 4),i=1,nlam) /  &
      1.9856,1.9831,1.9791,1.9738,1.9666,1.9573,1.9433,1.9244,    &
      1.8972,1.8597,1.8088,1.7425,1.6650,1.5801,1.4889,1.3909,    &
      1.2913,1.2008,1.1175,1.0628,1.0293,1.0000,1.0000,1.0000,    &
      1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,    &
      1.0000,1.0000,1.0000,1.0000,1.0000,1.0000 /
   data (omega(i, 4, 4),i=1,nlam) /  &
      1.9892,1.9872,1.9847,1.9810,1.9759,1.9684,1.9578,1.9428,    &
      1.9209,1.8903,1.8481,1.7923,1.7247,1.6511,1.5670,1.4750,    &
      1.3770,1.2778,1.1889,1.1084,1.0569,1.0260,1.0000,1.0000,    &
      1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,    &
      1.0000,1.0000,1.0000,1.0000,1.0000,1.0000 /
   data (omega(i, 5, 4),i=1,nlam) /  &
      1.9917,1.9902,1.9879,1.9851,1.9815,1.9755,1.9669,1.9546,    &
      1.9369,1.9112,1.8753,1.8266,1.7683,1.7020,1.6256,1.5400,    &
      1.4449,1.3478,1.2501,1.1650,1.0907,1.0456,1.0201,1.0000,    &
      1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,    &
      1.0000,1.0000,1.0000,1.0000,1.0000,1.0000 /
   data (omega(i, 6, 4),i=1,nlam) /  &
      1.9925,1.9918,1.9897,1.9876,1.9850,1.9804,1.9733,1.9630,    &
      1.9480,1.9263,1.8947,1.8527,1.8003,1.7417,1.6724,1.5919,    &
      1.5024,1.4056,1.3057,1.2138,1.1276,1.0698,1.0332,1.0000,    &
      1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,    &
      1.0000,1.0000,1.0000,1.0000,1.0000,1.0000 /
   data (omega(i, 7, 4),i=1,nlam) /  &
      1.9939,1.9925,1.9915,1.9898,1.9873,1.9839,1.9780,1.9691,    &
      1.9562,1.9374,1.9100,1.8720,1.8258,1.7719,1.7083,1.6338,    &
      1.5493,1.4552,1.3581,1.2599,1.1733,1.0968,1.0494,1.0220,    &
      1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,    &
      1.0000,1.0000,1.0000,1.0000,1.0000,1.0000 /
   data (omega(i, 8, 4),i=1,nlam) /  &
      1.9949,1.9938,1.9920,1.9905,1.9886,1.9861,1.9814,1.9738,    &
      1.9625,1.9460,1.9220,1.8880,1.8456,1.7963,1.7387,1.6699,    &
      1.5888,1.4977,1.4023,1.3024,1.2109,1.1254,1.0682,1.0323,    &
      1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,    &
      1.0000,1.0000,1.0000,1.0000,1.0000,1.0000 /
   data (omega(i, 9, 4),i=1,nlam) /  &
      1.9941,1.9937,1.9931,1.9918,1.9902,1.9877,1.9840,1.9775,    &
      1.9675,1.9528,1.9313,1.9009,1.8617,1.8172,1.7631,1.6986,    &
      1.6223,1.5364,1.4416,1.3443,1.2469,1.1623,1.0888,1.0444,    &
      1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,    &
      1.0000,1.0000,1.0000,1.0000,1.0000,1.0000 /
   data (omega(i,10, 4),i=1,nlam) /  &
      1.9954,1.9952,1.9948,1.9937,1.9915,1.9898,1.9874,1.9827,    &
      1.9748,1.9628,1.9452,1.9201,1.8869,1.8482,1.8019,1.7448,    &
      1.6775,1.5976,1.5078,1.4126,1.3127,1.2202,1.1327,1.0733,    &
      1.0352,1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,    &
      1.0000,1.0000,1.0000,1.0000,1.0000,1.0000 /
   data (omega(i,11, 4),i=1,nlam) /  &
      1.9963,1.9965,1.9951,1.9940,1.9931,1.9919,1.9896,1.9857,    &
      1.9798,1.9698,1.9550,1.9337,1.9053,1.8716,1.8302,1.7793,    &
      1.7185,1.6467,1.5625,1.4697,1.3729,1.2741,1.1856,1.1060,    &
      1.0553,1.0251,1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,    &
      1.0000,1.0000,1.0000,1.0000,1.0000,1.0000 /
   data (omega(i,12, 4),i=1,nlam) /  &
      1.9969,1.9958,1.9957,1.9949,1.9943,1.9919,1.9906,1.9883,    &
      1.9834,1.9749,1.9622,1.9438,1.9193,1.8895,1.8526,1.8069,    &
      1.7511,1.6850,1.6078,1.5193,1.4230,1.3258,1.2296,1.1403,    &
      1.0786,1.0383,1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,    &
      1.0000,1.0000,1.0000,1.0000,1.0000,1.0000 /
   data (omega(i,13, 4),i=1,nlam) /  &
      1.9974,1.9966,1.9962,1.9954,1.9951,1.9931,1.9921,1.9894,    &
      1.9854,1.9788,1.9678,1.9516,1.9299,1.9031,1.8699,1.8284,    &
      1.7772,1.7163,1.6442,1.5600,1.4665,1.3697,1.2710,1.1829,    &
      1.1039,1.0540,1.0245,1.0000,1.0000,1.0000,1.0000,1.0000,    &
      1.0000,1.0000,1.0000,1.0000,1.0000,1.0000 /
   data (omega(i,14, 4),i=1,nlam) /  &
      1.9977,1.9971,1.9967,1.9961,1.9944,1.9940,1.9932,1.9901,    &
      1.9875,1.9818,1.9721,1.9578,1.9384,1.9146,1.8845,1.8466,    &
      1.7996,1.7420,1.6748,1.5943,1.5045,1.4093,1.3093,1.2172,    &
      1.1303,1.0716,1.0342,1.0000,1.0000,1.0000,1.0000,1.0000,    &
      1.0000,1.0000,1.0000,1.0000,1.0000,1.0000 /
   data (omega(i, 1, 5),i=1,nlam) /  &
      1.9710,1.9660,1.9605,1.9539,1.9453,1.9341,1.9193,1.8991,    &
      1.8718,1.8350,1.7854,1.7209,1.6376,1.5376,1.4288,1.3269,    &
      1.2299,1.1402,1.0784,1.0381,1.0000,1.0000,1.0000,1.0000,    &
      1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,    &
      1.0000,1.0000,1.0000,1.0000,1.0000,1.0000 /
   data (omega(i, 2, 5),i=1,nlam) /  &
      1.9836,1.9809,1.9777,1.9735,1.9682,1.9611,1.9510,1.9378,    &
      1.9196,1.8939,1.8587,1.8107,1.7469,1.6658,1.5743,1.4776,    &
      1.3800,1.2807,1.1913,1.1102,1.0580,1.0266,1.0000,1.0000,    &
      1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,    &
      1.0000,1.0000,1.0000,1.0000,1.0000,1.0000 /
   data (omega(i, 3, 5),i=1,nlam) /  &
      1.9888,1.9873,1.9851,1.9826,1.9788,1.9737,1.9668,1.9572,    &
      1.9437,1.9243,1.8971,1.8596,1.8086,1.7422,1.6646,1.5795,    &
      1.4883,1.3902,1.2906,1.2001,1.1169,1.0625,1.0291,1.0000,    &
      1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,    &
      1.0000,1.0000,1.0000,1.0000,1.0000,1.0000 /
   data (omega(i, 4, 5),i=1,nlam) /  &
      1.9914,1.9901,1.9889,1.9871,1.9847,1.9809,1.9757,1.9683,    &
      1.9577,1.9428,1.9209,1.8902,1.8480,1.7921,1.7244,1.6507,    &
      1.5664,1.4743,1.3763,1.2771,1.1883,1.1079,1.0565,1.0258,    &
      1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,    &
      1.0000,1.0000,1.0000,1.0000,1.0000,1.0000 /
   data (omega(i, 5, 5),i=1,nlam) /  &
      1.9926,1.9916,1.9908,1.9896,1.9878,1.9854,1.9812,1.9754,    &
      1.9669,1.9546,1.9369,1.9111,1.8753,1.8265,1.7681,1.7016,    &
      1.6251,1.5394,1.4442,1.3470,1.2494,1.1644,1.0903,1.0453,    &
      1.0200,1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,    &
      1.0000,1.0000,1.0000,1.0000,1.0000,1.0000 /
   data (omega(i, 6, 5),i=1,nlam) /  &
      1.9938,1.9936,1.9926,1.9917,1.9895,1.9878,1.9850,1.9802,    &
      1.9732,1.9630,1.9480,1.9263,1.8947,1.8525,1.8001,1.7414,    &
      1.6719,1.5913,1.5018,1.4049,1.3050,1.2131,1.1271,1.0694,    &
      1.0329,1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,    &
      1.0000,1.0000,1.0000,1.0000,1.0000,1.0000 /
   data (omega(i, 7, 5),i=1,nlam) /  &
      1.9950,1.9938,1.9926,1.9919,1.9914,1.9891,1.9871,1.9837,    &
      1.9778,1.9691,1.9562,1.9374,1.9100,1.8725,1.8257,1.7717,    &
      1.7080,1.6333,1.5487,1.4545,1.3574,1.2592,1.1727,1.0963,    &
      1.0491,1.0220,1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,    &
      1.0000,1.0000,1.0000,1.0000,1.0000,1.0000 /
   data (omega(i, 8, 5),i=1,nlam) /  &
      1.9959,1.9950,1.9938,1.9931,1.9928,1.9908,1.9891,1.9863,    &
      1.9813,1.9737,1.9625,1.9459,1.9220,1.8879,1.8455,1.7961,    &
      1.7384,1.6694,1.5882,1.4972,1.4016,1.3017,1.2103,1.1248,    &
      1.0678,1.0321,1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,    &
      1.0000,1.0000,1.0000,1.0000,1.0000,1.0000 /
   data (omega(i, 9, 5),i=1,nlam) /  &
      1.9966,1.9958,1.9947,1.9943,1.9925,1.9920,1.9897,1.9877,    &
      1.9839,1.9774,1.9675,1.9528,1.9313,1.9008,1.8616,1.8171,    &
      1.7628,1.6982,1.6217,1.5358,1.4409,1.3436,1.2462,1.1619,    &
      1.0883,1.0442,1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,    &
      1.0000,1.0000,1.0000,1.0000,1.0000,1.0000 /
   data (omega(i,10, 5),i=1,nlam) /  &
      1.9957,1.9964,1.9960,1.9957,1.9937,1.9938,1.9919,1.9905,    &
      1.9871,1.9830,1.9747,1.9628,1.9452,1.9201,1.8868,1.8481,    &
      1.8017,1.7445,1.6770,1.5971,1.5071,1.4119,1.3120,1.2195,    &
      1.1321,1.0729,1.0350,1.0000,1.0000,1.0000,1.0000,1.0000,    &
      1.0000,1.0000,1.0000,1.0000,1.0000,1.0000 /
   data (omega(i,11, 5),i=1,nlam) /  &
      1.9966,1.9958,1.9967,1.9950,1.9953,1.9948,1.9934,1.9913,    &
      1.9897,1.9861,1.9797,1.9698,1.9550,1.9337,1.9053,1.8715,    &
      1.8300,1.7790,1.7181,1.6462,1.5620,1.4690,1.3722,1.2733,    &
      1.1850,1.1055,1.0549,1.0250,1.0000,1.0000,1.0000,1.0000,    &
      1.0000,1.0000,1.0000,1.0000,1.0000,1.0000 /
   data (omega(i,12, 5),i=1,nlam) /  &
      1.9972,1.9968,1.9972,1.9958,1.9961,1.9940,1.9945,1.9927,    &
      1.9903,1.9880,1.9832,1.9749,1.9622,1.9438,1.9193,1.8894,    &
      1.8525,1.8067,1.7508,1.6845,1.6073,1.5187,1.4223,1.3254,    &
      1.2289,1.1397,1.0782,1.0380,1.0000,1.0000,1.0000,1.0000,    &
      1.0000,1.0000,1.0000,1.0000,1.0000,1.0000 /
   data (omega(i,13, 5),i=1,nlam) /  &
      1.9976,1.9974,1.9962,1.9963,1.9966,1.9946,1.9951,1.9938,    &
      1.9916,1.9898,1.9859,1.9788,1.9678,1.9516,1.9299,1.9031,    &
      1.8698,1.8282,1.7769,1.7159,1.6437,1.5594,1.4658,1.3690,    &
      1.2702,1.1823,1.1034,1.0536,1.0243,1.0000,1.0000,1.0000,    &
      1.0000,1.0000,1.0000,1.0000,1.0000,1.0000 /
   data (omega(i,14, 5),i=1,nlam) /  &
      1.9979,1.9980,1.9967,1.9967,1.9971,1.9958,1.9957,1.9945,    &
      1.9927,1.9901,1.9873,1.9822,1.9721,1.9578,1.9384,1.9146,    &
      1.8844,1.8464,1.7994,1.7417,1.6743,1.5954,1.5039,1.4086,    &
      1.3086,1.2165,1.1297,1.0712,1.0340,1.0000,1.0000,1.0000,    &
      1.0000,1.0000,1.0000,1.0000,1.0000,1.0000 /
   data (omega(i, 1, 6),i=1,nlam) /  &
      1.9763,1.9729,1.9694,1.9652,1.9601,1.9536,1.9452,1.9340,    &
      1.9192,1.8990,1.8717,1.8349,1.7853,1.7209,1.6375,1.5374,    &
      1.4286,1.3267,1.2297,1.1400,1.0783,1.0381,1.0000,1.0000,    &
      1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,    &
      1.0000,1.0000,1.0000,1.0000,1.0000,1.0000 /
   data (omega(i, 2, 6),i=1,nlam) /  &
      1.9867,1.9847,1.9831,1.9806,1.9774,1.9734,1.9681,1.9610,    &
      1.9510,1.9378,1.9196,1.8939,1.8587,1.8107,1.7469,1.6657,    &
      1.5741,1.4774,1.3798,1.2805,1.1912,1.1100,1.0579,1.0265,    &
      1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,    &
      1.0000,1.0000,1.0000,1.0000,1.0000,1.0000 /
   data (omega(i, 3, 6),i=1,nlam) /  &
      1.9900,1.9893,1.9884,1.9869,1.9847,1.9825,1.9788,1.9737,    &
      1.9668,1.9572,1.9437,1.9243,1.8976,1.8596,1.8086,1.7421,    &
      1.6645,1.5794,1.4881,1.3900,1.2904,1.2000,1.1168,1.0624,    &
      1.0290,1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,    &
      1.0000,1.0000,1.0000,1.0000,1.0000,1.0000 /
   data (omega(i, 4, 6),i=1,nlam) /  &
      1.9930,1.9912,1.9909,1.9897,1.9889,1.9868,1.9846,1.9809,    &
      1.9756,1.9683,1.9577,1.9428,1.9209,1.8902,1.8480,1.7921,    &
      1.7243,1.6506,1.5663,1.4742,1.3761,1.2769,1.1881,1.1078,    &
      1.0564,1.0258,1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,    &
      1.0000,1.0000,1.0000,1.0000,1.0000,1.0000 /
   data (omega(i, 5, 6),i=1,nlam) /  &
      1.9936,1.9931,1.9930,1.9919,1.9907,1.9899,1.9877,1.9853,    &
      1.9812,1.9753,1.9669,1.9546,1.9369,1.9111,1.8752,1.8265,    &
      1.7680,1.7015,1.6250,1.5392,1.4441,1.3469,1.2492,1.1645,    &
      1.0901,1.0453,1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,    &
      1.0000,1.0000,1.0000,1.0000,1.0000,1.0000 /
   data (omega(i, 6, 6),i=1,nlam) /  &
      1.9950,1.9947,1.9931,1.9933,1.9924,1.9911,1.9893,1.9878,    &
      1.9850,1.9802,1.9732,1.9630,1.9480,1.9263,1.8947,1.8525,    &
      1.8001,1.7413,1.6718,1.5912,1.5016,1.4047,1.3048,1.2130,    &
      1.1269,1.0693,1.0329,1.0000,1.0000,1.0000,1.0000,1.0000,    &
      1.0000,1.0000,1.0000,1.0000,1.0000,1.0000 /
   data (omega(i, 7, 6),i=1,nlam) /  &
      1.9956,1.9943,1.9942,1.9943,1.9935,1.9924,1.9910,1.9899,    &
      1.9871,1.9837,1.9778,1.9691,1.9562,1.9374,1.9100,1.8725,    &
      1.8256,1.7716,1.7079,1.6331,1.5485,1.4543,1.3572,1.2590,    &
      1.1726,1.0962,1.0490,1.0220,1.0000,1.0000,1.0000,1.0000,    &
      1.0000,1.0000,1.0000,1.0000,1.0000,1.0000 /
   data (omega(i, 8, 6),i=1,nlam) /  &
      1.9964,1.9954,1.9950,1.9952,1.9943,1.9934,1.9922,1.9905,    &
      1.9891,1.9863,1.9812,1.9738,1.9625,1.9459,1.9220,1.8879,    &
      1.8454,1.7960,1.7383,1.6693,1.5881,1.4970,1.4014,1.3015,    &
      1.2101,1.1247,1.0677,1.0320,1.0000,1.0000,1.0000,1.0000,    &
      1.0000,1.0000,1.0000,1.0000,1.0000,1.0000 /
   data (omega(i, 9, 6),i=1,nlam) /  &
      1.9970,1.9967,1.9957,1.9958,1.9950,1.9942,1.9931,1.9916,    &
      1.9906,1.9877,1.9839,1.9774,1.9675,1.9527,1.9313,1.9008,    &
      1.8615,1.8170,1.7628,1.6980,1.6216,1.5356,1.4407,1.3434,    &
      1.2460,1.1536,1.0882,1.0441,1.0000,1.0000,1.0000,1.0000,    &
      1.0000,1.0000,1.0000,1.0000,1.0000,1.0000 /
   data (omega(i,10, 6),i=1,nlam) /  &
      1.9963,1.9962,1.9966,1.9951,1.9960,1.9952,1.9944,1.9933,    &
      1.9917,1.9905,1.9871,1.9831,1.9747,1.9628,1.9452,1.9201,    &
      1.8868,1.8480,1.8017,1.7444,1.6769,1.5969,1.5070,1.4118,    &
      1.3118,1.2194,1.1320,1.0728,1.0349,1.0000,1.0000,1.0000,    &
      1.0000,1.0000,1.0000,1.0000,1.0000,1.0000 /
   data (omega(i,11, 6),i=1,nlam) /  &
      1.9965,1.9972,1.9971,1.9958,1.9966,1.9958,1.9952,1.9944,    &
      1.9931,1.9912,1.9896,1.9861,1.9797,1.9698,1.9550,1.9337,    &
      1.9053,1.8715,1.8300,1.7790,1.7180,1.6461,1.5618,1.4707,    &
      1.3720,1.2732,1.1849,1.1053,1.0549,1.0250,1.0000,1.0000,    &
      1.0000,1.0000,1.0000,1.0000,1.0000,1.0000 /
   data (omega(i,12, 6),i=1,nlam) /  &
      1.9972,1.9980,1.9976,1.9958,1.9971,1.9963,1.9956,1.9950,    &
      1.9941,1.9925,1.9903,1.9879,1.9832,1.9749,1.9622,1.9438,    &
      1.9193,1.8894,1.8525,1.8067,1.7508,1.6844,1.6072,1.5185,    &
      1.4221,1.3220,1.2288,1.1395,1.0781,1.0380,1.0000,1.0000,    &
      1.0000,1.0000,1.0000,1.0000,1.0000,1.0000 /
   data (omega(i,13, 6),i=1,nlam) /  &
      1.9977,1.9969,1.9980,1.9960,1.9974,1.9967,1.9960,1.9954,    &
      1.9947,1.9935,1.9916,1.9898,1.9859,1.9788,1.9678,1.9516,    &
      1.9299,1.9036,1.8698,1.8282,1.7768,1.7158,1.6436,1.5593,    &
      1.4677,1.3688,1.2701,1.1822,1.1033,1.0536,1.0000,1.0000,    &
      1.0000,1.0000,1.0000,1.0000,1.0000,1.0000 /
   data (omega(i,14, 6),i=1,nlam) /  &
      1.9979,1.9973,1.9958,1.9970,1.9977,1.9970,1.9963,1.9958,    &
      1.9951,1.9941,1.9925,1.9912,1.9873,1.9822,1.9721,1.9578,    &
      1.9384,1.9146,1.8844,1.8464,1.7994,1.7416,1.6742,1.5953,    &
      1.5057,1.4084,1.3084,1.2163,1.1296,1.0711,1.0339,1.0000,    &
      1.0000,1.0000,1.0000,1.0000,1.0000,1.0000 /
   data (omega(i, 1, 7),i=1,nlam) /  &
      1.9812,1.9780,1.9751,1.9723,1.9690,1.9650,1.9600,1.9535,    &
      1.9451,1.9340,1.9192,1.8990,1.8718,1.8349,1.7854,1.7209,    &
      1.6376,1.5375,1.4287,1.3268,1.2297,1.1401,1.0783,1.0381,    &
      1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,    &
      1.0000,1.0000,1.0000,1.0000,1.0000,1.0000 /
   data (omega(i, 2, 7),i=1,nlam) /  &
      1.9884,1.9875,1.9860,1.9843,1.9829,1.9805,1.9774,1.9734,    &
      1.9681,1.9610,1.9510,1.9378,1.9196,1.8944,1.8587,1.8107,    &
      1.7469,1.6658,1.5742,1.4774,1.3799,1.2806,1.1912,1.1100,    &
      1.0579,1.0266,1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,    &
      1.0000,1.0000,1.0000,1.0000,1.0000,1.0000 /
   data (omega(i, 3, 7),i=1,nlam) /  &
      1.9920,1.9911,1.9901,1.9890,1.9884,1.9868,1.9852,1.9824,    &
      1.9787,1.9737,1.9668,1.9572,1.9438,1.9243,1.8976,1.8596,    &
      1.8086,1.7422,1.6646,1.5794,1.4882,1.3900,1.2904,1.2000,    &
      1.1168,1.0624,1.0290,1.0000,1.0000,1.0000,1.0000,1.0000,    &
      1.0000,1.0000,1.0000,1.0000,1.0000,1.0000 /
   data (omega(i, 4, 7),i=1,nlam) /  &
      1.9941,1.9934,1.9927,1.9918,1.9908,1.9896,1.9888,1.9868,    &
      1.9846,1.9809,1.9756,1.9683,1.9578,1.9428,1.9209,1.8902,    &
      1.8480,1.7921,1.7244,1.6506,1.5663,1.4742,1.3761,1.2770,    &
      1.1882,1.1078,1.0565,1.0258,1.0000,1.0000,1.0000,1.0000,    &
      1.0000,1.0000,1.0000,1.0000,1.0000,1.0000 /
   data (omega(i, 5, 7),i=1,nlam) /  &
      1.9942,1.9947,1.9943,1.9937,1.9929,1.9919,1.9907,1.9899,    &
      1.9877,1.9853,1.9812,1.9753,1.9669,1.9546,1.9370,1.9111,    &
      1.8753,1.8265,1.7681,1.7015,1.6250,1.5393,1.4441,1.3469,    &
      1.2493,1.1646,1.0902,1.0453,1.0000,1.0000,1.0000,1.0000,    &
      1.0000,1.0000,1.0000,1.0000,1.0000,1.0000 /
   data (omega(i, 6, 7),i=1,nlam) /  &
      1.9952,1.9956,1.9952,1.9947,1.9941,1.9933,1.9923,1.9910,    &
      1.9893,1.9878,1.9850,1.9802,1.9732,1.9630,1.9480,1.9264,    &
      1.8952,1.8525,1.8001,1.7413,1.6719,1.5912,1.5016,1.4048,    &
      1.3048,1.2130,1.1270,1.0693,1.0329,1.0000,1.0000,1.0000,    &
      1.0000,1.0000,1.0000,1.0000,1.0000,1.0000 /
   data (omega(i, 7, 7),i=1,nlam) /  &
      1.9960,1.9963,1.9957,1.9954,1.9949,1.9942,1.9934,1.9924,    &
      1.9910,1.9899,1.9871,1.9837,1.9778,1.9691,1.9562,1.9374,    &
      1.9100,1.8726,1.8256,1.7717,1.7080,1.6332,1.5486,1.4563,    &
      1.3572,1.2590,1.1727,1.0962,1.0491,1.0000,1.0000,1.0000,    &
      1.0000,1.0000,1.0000,1.0000,1.0000,1.0000 /
   data (omega(i, 8, 7),i=1,nlam) /  &
      1.9967,1.9969,1.9963,1.9960,1.9956,1.9950,1.9943,1.9934,    &
      1.9921,1.9905,1.9891,1.9863,1.9812,1.9738,1.9625,1.9460,    &
      1.9220,1.8879,1.8455,1.7961,1.7383,1.6694,1.5881,1.4970,    &
      1.4015,1.3016,1.2101,1.1247,1.0678,1.0320,1.0000,1.0000,    &
      1.0000,1.0000,1.0000,1.0000,1.0000,1.0000 /
   data (omega(i, 9, 7),i=1,nlam) /  &
      1.9973,1.9973,1.9968,1.9964,1.9961,1.9956,1.9949,1.9941,    &
      1.9931,1.9916,1.9906,1.9877,1.9839,1.9774,1.9675,1.9528,    &
      1.9313,1.9008,1.8616,1.8171,1.7628,1.6980,1.6217,1.5357,    &
      1.4408,1.3435,1.2461,1.1537,1.0882,1.0441,1.0000,1.0000,    &
      1.0000,1.0000,1.0000,1.0000,1.0000,1.0000 /
   data (omega(i,10, 7),i=1,nlam) /  &
      1.9980,1.9965,1.9972,1.9966,1.9965,1.9962,1.9957,1.9952,    &
      1.9944,1.9933,1.9917,1.9905,1.9871,1.9831,1.9747,1.9628,    &
      1.9452,1.9201,1.8868,1.8481,1.8017,1.7445,1.6770,1.5970,    &
      1.5088,1.4118,1.3118,1.2194,1.1320,1.0728,1.0349,1.0000,    &
      1.0000,1.0000,1.0000,1.0000,1.0000,1.0000 /
   data (omega(i,11, 7),i=1,nlam) /  &
      1.9974,1.9973,1.9976,1.9970,1.9968,1.9965,1.9961,1.9957,    &
      1.9952,1.9943,1.9931,1.9913,1.9896,1.9861,1.9806,1.9698,    &
      1.9550,1.9337,1.9053,1.8715,1.8300,1.7790,1.7181,1.6461,    &
      1.5619,1.4689,1.3721,1.2732,1.1849,1.1054,1.0549,1.0251,    &
      1.0000,1.0000,1.0000,1.0000,1.0000,1.0000 /
   data (omega(i,12, 7),i=1,nlam) /  &
      1.9963,1.9979,1.9980,1.9973,1.9971,1.9968,1.9965,1.9961,    &
      1.9956,1.9950,1.9940,1.9925,1.9903,1.9880,1.9833,1.9749,    &
      1.9622,1.9438,1.9193,1.8894,1.8525,1.8067,1.7508,1.6845,    &
      1.6072,1.5185,1.4221,1.3221,1.2288,1.1396,1.0781,1.0380,    &
      1.0000,1.0000,1.0000,1.0000,1.0000,1.0000 /
   data (omega(i,13, 7),i=1,nlam) /  &
      1.9970,1.9983,1.9954,1.9975,1.9970,1.9969,1.9967,1.9964,    &
      1.9959,1.9954,1.9946,1.9935,1.9916,1.9898,1.9859,1.9793,    &
      1.9678,1.9516,1.9300,1.9036,1.8698,1.8282,1.7768,1.7158,    &
      1.6436,1.5593,1.4657,1.3689,1.2701,1.1823,1.1033,1.0536,    &
      1.0000,1.0000,1.0000,1.0000,1.0000,1.0000 /
   data (omega(i,14, 7),i=1,nlam) /  &
      1.9976,1.9978,1.9957,1.9976,1.9969,1.9968,1.9967,1.9965,    &
      1.9962,1.9957,1.9951,1.9941,1.9925,1.9912,1.9873,1.9822,    &
      1.9721,1.9578,1.9384,1.9146,1.8844,1.8464,1.7994,1.7416,    &
      1.6743,1.5953,1.5057,1.4084,1.3084,1.2164,1.1296,1.0711,    &
      1.0339,1.0000,1.0000,1.0000,1.0000,1.0000 /
   data (omega(i, 1, 8),i=1,nlam) /  &
      1.9875,1.9840,1.9804,1.9775,1.9749,1.9721,1.9689,1.9650,    &
      1.9600,1.9535,1.9451,1.9340,1.9192,1.8994,1.8718,1.8349,    &
      1.7854,1.7209,1.6376,1.5375,1.4286,1.3268,1.2297,1.1400,    &
      1.0783,1.0381,1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,    &
      1.0000,1.0000,1.0000,1.0000,1.0000,1.0000 /
   data (omega(i, 2, 8),i=1,nlam) /  &
      1.9912,1.9893,1.9878,1.9872,1.9858,1.9847,1.9828,1.9804,    &
      1.9774,1.9734,1.9681,1.9610,1.9517,1.9378,1.9196,1.8944,    &
      1.8587,1.8107,1.7469,1.6658,1.5742,1.4774,1.3798,1.2806,    &
      1.1912,1.1100,1.0579,1.0266,1.0000,1.0000,1.0000,1.0000,    &
      1.0000,1.0000,1.0000,1.0000,1.0000,1.0000 /
   data (omega(i, 3, 8),i=1,nlam) /  &
      1.9923,1.9925,1.9917,1.9909,1.9900,1.9889,1.9884,1.9868,    &
      1.9852,1.9824,1.9787,1.9737,1.9668,1.9572,1.9439,1.9243,    &
      1.8976,1.8596,1.8086,1.7422,1.6646,1.5794,1.4882,1.3900,    &
      1.2904,1.2000,1.1168,1.0624,1.0290,1.0000,1.0000,1.0000,    &
      1.0000,1.0000,1.0000,1.0000,1.0000,1.0000 /
   data (omega(i, 4, 8),i=1,nlam) /  &
      1.9938,1.9931,1.9925,1.9933,1.9926,1.9918,1.9908,1.9896,    &
      1.9888,1.9868,1.9846,1.9809,1.9756,1.9683,1.9578,1.9429,    &
      1.9209,1.8902,1.8480,1.7921,1.7244,1.6506,1.5663,1.4742,    &
      1.3761,1.2770,1.1881,1.1078,1.0565,1.0258,1.0000,1.0000,    &
      1.0000,1.0000,1.0000,1.0000,1.0000,1.0000 /
   data (omega(i, 5, 8),i=1,nlam) /  &
      1.9948,1.9943,1.9938,1.9947,1.9942,1.9936,1.9928,1.9919,    &
      1.9906,1.9899,1.9877,1.9853,1.9812,1.9753,1.9669,1.9546,    &
      1.9370,1.9111,1.8753,1.8265,1.7681,1.7015,1.6250,1.5393,    &
      1.4441,1.3469,1.2493,1.1645,1.0902,1.0453,1.0000,1.0000,    &
      1.0000,1.0000,1.0000,1.0000,1.0000,1.0000 /
   data (omega(i, 6, 8),i=1,nlam) /  &
      1.9966,1.9963,1.9959,1.9955,1.9951,1.9946,1.9940,1.9933,    &
      1.9923,1.9910,1.9893,1.9878,1.9850,1.9802,1.9732,1.9630,    &
      1.9480,1.9263,1.8952,1.8525,1.8001,1.7413,1.6719,1.5912,    &
      1.5016,1.4048,1.3048,1.2130,1.1270,1.0693,1.0329,1.0000,    &
      1.0000,1.0000,1.0000,1.0000,1.0000,1.0000 /
   data (omega(i, 7, 8),i=1,nlam) /  &
      1.9970,1.9968,1.9965,1.9961,1.9958,1.9954,1.9949,1.9942,    &
      1.9934,1.9924,1.9910,1.9899,1.9871,1.9837,1.9778,1.9691,    &
      1.9562,1.9374,1.9100,1.8726,1.8256,1.7716,1.7080,1.6332,    &
      1.5486,1.4544,1.3572,1.2590,1.1727,1.0962,1.0491,1.0000,    &
      1.0000,1.0000,1.0000,1.0000,1.0000,1.0000 /
   data (omega(i, 8, 8),i=1,nlam) /  &
      1.9974,1.9972,1.9969,1.9966,1.9963,1.9960,1.9955,1.9950,    &
      1.9943,1.9933,1.9921,1.9905,1.9891,1.9863,1.9831,1.9738,    &
      1.9625,1.9460,1.9220,1.8879,1.8455,1.7961,1.7383,1.6693,    &
      1.5881,1.4991,1.4015,1.3016,1.2101,1.1247,1.0677,1.0320,    &
      1.0000,1.0000,1.0000,1.0000,1.0000,1.0000 /
   data (omega(i, 9, 8),i=1,nlam) /  &
      1.9976,1.9975,1.9972,1.9970,1.9967,1.9964,1.9960,1.9955,    &
      1.9949,1.9941,1.9931,1.9916,1.9906,1.9877,1.9839,1.9774,    &
      1.9675,1.9528,1.9313,1.9008,1.8622,1.8171,1.7628,1.6980,    &
      1.6217,1.5357,1.4408,1.3434,1.2461,1.1537,1.0882,1.0441,    &
      1.0000,1.0000,1.0000,1.0000,1.0000,1.0000 /
   data (omega(i,10, 8),i=1,nlam) /  &
      1.9979,1.9974,1.9974,1.9972,1.9970,1.9968,1.9965,1.9961,    &
      1.9957,1.9952,1.9944,1.9933,1.9917,1.9905,1.9871,1.9833,    &
      1.9747,1.9628,1.9452,1.9201,1.8868,1.8481,1.8017,1.7445,    &
      1.6770,1.5970,1.5088,1.4118,1.3118,1.2194,1.1320,1.0728,    &
      1.0349,1.0000,1.0000,1.0000,1.0000,1.0000 /
   data (omega(i,11, 8),i=1,nlam) /  &
      1.9983,1.9977,1.9976,1.9974,1.9972,1.9970,1.9968,1.9965,    &
      1.9961,1.9957,1.9951,1.9943,1.9931,1.9912,1.9896,1.9861,    &
      1.9809,1.9698,1.9550,1.9337,1.9053,1.8721,1.8300,1.7790,    &
      1.7181,1.6461,1.5618,1.4689,1.3721,1.2732,1.1850,1.1053,    &
      1.0549,1.0000,1.0000,1.0000,1.0000,1.0000 /
   data (omega(i,12, 8),i=1,nlam) /  &
      1.9958,1.9979,1.9973,1.9976,1.9974,1.9972,1.9970,1.9967,    &
      1.9964,1.9961,1.9956,1.9949,1.9940,1.9925,1.9903,1.9879,    &
      1.9832,1.9749,1.9622,1.9438,1.9193,1.8894,1.8525,1.8067,    &
      1.7508,1.6845,1.6072,1.5185,1.4221,1.3220,1.2288,1.1395,    &
      1.0781,1.0380,1.0000,1.0000,1.0000,1.0000 /
   data (omega(i,13, 8),i=1,nlam) /  &
      1.9965,1.9980,1.9972,1.9974,1.9973,1.9971,1.9970,1.9968,    &
      1.9966,1.9963,1.9959,1.9954,1.9946,1.9934,1.9916,1.9898,    &
      1.9859,1.9794,1.9678,1.9516,1.9300,1.9036,1.8698,1.8282,    &
      1.7768,1.7172,1.6436,1.5593,1.4657,1.3689,1.2701,1.1825,    &
      1.1033,1.0536,1.0000,1.0000,1.0000,1.0000 /
   data (omega(i,14, 8),i=1,nlam) /  &
      1.9974,1.9981,1.9972,1.9971,1.9970,1.9968,1.9967,1.9967,    &
      1.9966,1.9965,1.9962,1.9957,1.9950,1.9941,1.9925,1.9912,    &
      1.9873,1.9822,1.9721,1.9578,1.9384,1.9146,1.8844,1.8464,    &
      1.7994,1.7430,1.6743,1.5953,1.5059,1.4084,1.3084,1.2163,    &
      1.1296,1.0711,1.0339,1.0000,1.0000,1.0000 /
   data (omega(i, 1, 9),i=1,nlam) /  &
      1.9931,1.9905,1.9872,1.9837,1.9802,1.9773,1.9748,1.9721,    &
      1.9689,1.9650,1.9599,1.9535,1.9451,1.9340,1.9192,1.8994,    &
      1.8723,1.8348,1.7851,1.7206,1.6372,1.5371,1.4283,1.3264,    &
      1.2294,1.1398,1.0781,1.0380,1.0000,1.0000,1.0000,1.0000,    &
      1.0000,1.0000,1.0000,1.0000,1.0000,1.0000 /
   data (omega(i, 2, 9),i=1,nlam) /  &
      1.9943,1.9920,1.9908,1.9891,1.9877,1.9871,1.9858,1.9847,    &
      1.9828,1.9804,1.9774,1.9734,1.9681,1.9610,1.9518,1.9377,    &
      1.9195,1.8943,1.8586,1.8105,1.7466,1.6655,1.5738,1.4771,    &
      1.3795,1.2802,1.1909,1.1098,1.0578,1.0265,1.0000,1.0000,    &
      1.0000,1.0000,1.0000,1.0000,1.0000,1.0000 /
   data (omega(i, 3, 9),i=1,nlam) /  &
      1.9948,1.9933,1.9921,1.9923,1.9916,1.9908,1.9899,1.9889,    &
      1.9884,1.9867,1.9852,1.9824,1.9787,1.9737,1.9668,1.9571,    &
      1.9440,1.9242,1.8975,1.8595,1.8084,1.7419,1.6643,1.5791,    &
      1.4878,1.3897,1.2901,1.1997,1.1166,1.0622,1.0289,1.0000,    &
      1.0000,1.0000,1.0000,1.0000,1.0000,1.0000 /
   data (omega(i, 4, 9),i=1,nlam) /  &
      1.9953,1.9943,1.9936,1.9930,1.9938,1.9932,1.9926,1.9918,    &
      1.9908,1.9896,1.9888,1.9868,1.9846,1.9808,1.9756,1.9682,    &
      1.9577,1.9428,1.9208,1.8900,1.8478,1.7919,1.7241,1.6503,    &
      1.5660,1.4738,1.3758,1.2766,1.1878,1.1075,1.0563,1.0257,    &
      1.0000,1.0000,1.0000,1.0000,1.0000,1.0000 /
   data (omega(i, 5, 9),i=1,nlam) /  &
      1.9959,1.9951,1.9946,1.9941,1.9937,1.9947,1.9942,1.9936,    &
      1.9928,1.9919,1.9906,1.9899,1.9877,1.9853,1.9812,1.9753,    &
      1.9669,1.9546,1.9369,1.9115,1.8751,1.8263,1.7678,1.7013,    &
      1.6247,1.5389,1.4458,1.3436,1.2489,1.1560,1.0899,1.0452,    &
      1.0000,1.0000,1.0000,1.0000,1.0000,1.0000 /
   data (omega(i, 6, 9),i=1,nlam) /  &
      1.9959,1.9968,1.9965,1.9962,1.9958,1.9955,1.9951,1.9946,    &
      1.9940,1.9933,1.9923,1.9910,1.9893,1.9878,1.9850,1.9802,    &
      1.9732,1.9629,1.9480,1.9263,1.8951,1.8524,1.7999,1.7411,    &
      1.6716,1.5909,1.5013,1.4044,1.3045,1.2127,1.1267,1.0691,    &
      1.0328,1.0000,1.0000,1.0000,1.0000,1.0000 /
   data (omega(i, 7, 9),i=1,nlam) /  &
      1.9975,1.9972,1.9969,1.9967,1.9964,1.9961,1.9958,1.9954,    &
      1.9948,1.9942,1.9934,1.9924,1.9909,1.9899,1.9871,1.9837,    &
      1.9778,1.9691,1.9562,1.9373,1.9099,1.8724,1.8255,1.7714,    &
      1.7077,1.6329,1.5482,1.4560,1.3568,1.2587,1.1642,1.0960,    &
      1.0489,1.0000,1.0000,1.0000,1.0000,1.0000 /
   data (omega(i, 8, 9),i=1,nlam) /  &
      1.9978,1.9975,1.9973,1.9971,1.9969,1.9966,1.9963,1.9960,    &
      1.9955,1.9950,1.9943,1.9933,1.9921,1.9905,1.9891,1.9863,    &
      1.9837,1.9737,1.9625,1.9459,1.9219,1.8878,1.8453,1.7959,    &
      1.7381,1.6691,1.5878,1.4987,1.4011,1.3012,1.2098,1.1244,    &
      1.0676,1.0319,1.0000,1.0000,1.0000,1.0000 /
   data (omega(i, 9, 9),i=1,nlam) /  &
      1.9980,1.9977,1.9976,1.9974,1.9972,1.9969,1.9967,1.9964,    &
      1.9960,1.9955,1.9949,1.9941,1.9931,1.9916,1.9906,1.9877,    &
      1.9839,1.9773,1.9675,1.9527,1.9312,1.9007,1.8614,1.8169,    &
      1.7626,1.6979,1.6214,1.5353,1.4404,1.3432,1.2457,1.1534,    &
      1.0880,1.0440,1.0000,1.0000,1.0000,1.0000 /
   data (omega(i,10, 9),i=1,nlam) /  &
      1.9980,1.9979,1.9977,1.9975,1.9974,1.9972,1.9970,1.9967,    &
      1.9965,1.9961,1.9957,1.9952,1.9944,1.9933,1.9917,1.9905,    &
      1.9871,1.9833,1.9747,1.9628,1.9451,1.9200,1.8867,1.8479,    &
      1.8015,1.7442,1.6767,1.5967,1.5086,1.4114,1.3115,1.2191,    &
      1.1318,1.0726,1.0348,1.0000,1.0000,1.0000 /
   data (omega(i,11, 9),i=1,nlam) /  &
      1.9981,1.9980,1.9979,1.9977,1.9975,1.9974,1.9972,1.9970,    &
      1.9968,1.9965,1.9961,1.9957,1.9951,1.9943,1.9931,1.9912,    &
      1.9896,1.9861,1.9807,1.9698,1.9549,1.9336,1.9052,1.8714,    &
      1.8299,1.7798,1.7178,1.6459,1.5615,1.4705,1.3717,1.2728,    &
      1.1846,1.1051,1.0547,1.0251,1.0000,1.0000 /
   data (omega(i,12, 9),i=1,nlam) /  &
      1.9982,1.9981,1.9979,1.9978,1.9976,1.9975,1.9973,1.9972,    &
      1.9970,1.9967,1.9964,1.9961,1.9956,1.9949,1.9940,1.9925,    &
      1.9903,1.9879,1.9832,1.9749,1.9622,1.9437,1.9192,1.8898,    &
      1.8523,1.8065,1.7506,1.6842,1.6069,1.5182,1.4218,1.3217,    &
      1.2285,1.1393,1.0779,1.0379,1.0000,1.0000 /
   data (omega(i,13, 9),i=1,nlam) /  &
      1.9980,1.9979,1.9978,1.9976,1.9975,1.9973,1.9972,1.9971,    &
      1.9970,1.9968,1.9966,1.9963,1.9959,1.9954,1.9946,1.9934,    &
      1.9916,1.9898,1.9859,1.9794,1.9677,1.9515,1.9299,1.9035,    &
      1.8703,1.8288,1.7778,1.7156,1.6433,1.5590,1.4654,1.3685,    &
      1.2697,1.1736,1.1031,1.0534,1.0000,1.0000 /
   data (omega(i,14, 9),i=1,nlam) /  &
      1.9974,1.9976,1.9974,1.9972,1.9971,1.9970,1.9968,1.9968,    &
      1.9967,1.9967,1.9966,1.9964,1.9962,1.9957,1.9950,1.9941,    &
      1.9925,1.9912,1.9873,1.9822,1.9721,1.9577,1.9383,1.9146,    &
      1.8848,1.8471,1.8003,1.7427,1.6740,1.5950,1.5053,1.4081,    &
      1.3081,1.2160,1.1293,1.0709,1.0339,1.0000 /

   loglam = log(4 * radsq / ( phibar * dt**2 ))/log(2.)

   if ( il < resol(1) .or. il >= resol(nres) ) then
      print*, "Error: resolution out of range in optmx"
      stop
   end if
   if ( schmidt > 1.0 .or. schmidt <= 0.5**(nsch-1) ) then
      print*, "Error: schmidt out of range in optmx", schmidt
      stop
   end if
   if ( loglam < 1.0 ) then
      print*, "Error: lambda out of range in optmx"
      stop
   end if

   ! Table size chosen so that this is true even for the highest resolution
   ! and stretching.
   if ( loglam > nlam-1 ) then
      accel = 1.0
      return
   end if

   ! Find i, such that lam(i) <= lambda < lam(i+1)
   !      j, such that res(j) <= il < res(j+1)
   !      k, such that sch(k) >= lambda > sch(k+1)
   
   i = 1 + floor(loglam)
   if ( il <= 100 ) then
      j = il/10 - 1
   else
      j = (il-100)/20 + 9
   end if
   logstr = -log(schmidt)/log(2.)
   k = 1 + floor(logstr)

   ! Interpolation weights
   wl = 1. - ( loglam - floor(loglam) )
   ws = 1. - ( logstr - floor(logstr) )
   wr = 1. - ( il - resol(j) )/ real(resol(j+1)-resol(j))

!  print*, "OPTMX LAM", loglam
!  print*, "OPTMX Interp parameters", i, j, k, wl, wr, ws

   accel = wl*wr*ws*omega(i,j,k) +                    &
           (1-wl)*wr*ws*omega(i+1,j,k) +              &
           wl*(1-wr)*ws*omega(i,j+1,k) +              &
           (1-wl)*(1-wr)*ws*omega(i+1,j+1,k) +        &
           wl*wr*(1-ws)*omega(i,j,k+1) +              &
           (1-wl)*wr*(1-ws)*omega(i+1,j,k+1) +        & 
           wl*(1-wr)*(1-ws)*omega(i,j+1,k+1) +        &
           (1-wl)*(1-wr)*(1-ws)*omega(i+1,j+1,k+1)
!  print*, "OPTMX accel", accel

end subroutine optmx
           
